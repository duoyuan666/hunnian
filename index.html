<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç›¸äº²æ–‡æ¡ˆå›¾ç‰‡ç”Ÿæˆå™¨</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
        }

        .form-group textarea {
            min-height: 200px;
            resize: vertical;
        }

        .slider-group {
            margin-bottom: 20px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        input[type="range"] {
            width: 100%;
        }

        .bg-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(90px, 1fr));
            gap: 10px;
            margin-top: 10px;
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }

        .bg-option {
            position: relative;
        }

        .bg-option input[type="radio"] {
            position: absolute;
            opacity: 0;
        }

        .bg-option label {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 8px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .bg-option input[type="radio"]:checked + label {
            border-color: #667eea;
            background: #f0f4ff;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
        }

        .bg-preview {
            width: 100%;
            height: 60px;
            border-radius: 4px;
            border: 1px solid rgba(0,0,0,0.1);
        }

        .bg-name {
            font-size: 10px;
            text-align: center;
            color: #666;
        }

        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .button-group {
            display: flex;
            gap: 10px;
        }

        .canvas-wrapper {
            margin-bottom: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }

        .canvas-label {
            margin-bottom: 10px;
            font-weight: 600;
            color: #667eea;
        }

        canvas {
            width: 100%;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 1024px) {
            .content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“¸ ç›¸äº²æ–‡æ¡ˆå›¾ç‰‡ç”Ÿæˆå™¨</h1>
            <p>æµ·é‡ç²¾ç¾èƒŒæ™¯ï¼Œä¸€é”®ç”Ÿæˆä¸“ä¸šç›¸äº²å›¾ç‰‡</p>
        </div>

        <div class="content">
            <div class="editor-section">
                <div class="section-title">âœï¸ ç¼–è¾‘å†…å®¹</div>

                <div class="form-group">
                    <label>ğŸ“ æ ‡é¢˜ï¼ˆç¬¬ä¸€é¡µï¼‰</label>
                    <input type="text" id="title" value="æˆéƒ½28å²å¤§å‚å·¥ç¨‹å¸ˆ æœ‰æˆ¿æœ‰è½¦æœ‰è´·">
                </div>

                <div class="form-group">
                    <label>ğŸ“„ å†…å®¹</label>
                    <textarea id="content">28å²ï¼Œæ¹–å—é•¿æ²™ä»”å­ï¼Œåœ¨æˆéƒ½å­¦ä¹ å·¥ä½œ8å¹´å·²æ‰æ ¹ï¼Œèº«é«˜178cmï¼Œä½“é‡72kgï¼Œæœ¬ç§‘æ¯•ä¸šäºç”µå­ç§‘æŠ€å¤§å­¦ï¼Œç›®å‰æ˜¯æŸäº’è”ç½‘å¤§å‚çš„åç«¯å¼€å‘å·¥ç¨‹å¸ˆï¼Œç¨åå¹´å…¥35w+

ç‹¬ç”Ÿå­ï¼Œçˆ¶æ¯æ˜¯é•¿æ²™å›½ä¼é€€ä¼‘èŒå·¥ï¼Œå…»è€æ— å¿§ï¼Œå®¶åº­æ°›å›´è¶…çº§æ°‘ä¸»å’Œç¦ï¼Œæ˜¯æˆ‘æœ€åšå®çš„åç›¾

å…¸å‹çš„INTPæ€§æ ¼ï¼Œå·¥ä½œä¸­æ˜¯ç†æ€§ä¸¥è°¨çš„ä»£ç å·¥ï¼Œç”Ÿæ´»é‡Œæ˜¯çƒ­è¡·æ¢ç´¢çš„ä½“éªŒå®¶ï¼Œæƒ…ç»ªç¨³å®šï¼Œè®²é“ç†å¥½æ²Ÿé€š

å‘å¾€çš„çˆ±æƒ…ï¼Œæ˜¯70%çš„è¸å®æ—¥å¸¸+30%çš„æ„å¤–æƒŠå–œï¼Œæˆ‘ä»¬æ—¢èƒ½å„è‡ªåœ¨äº‹ä¸šä¸ŠåŠªåŠ›å¥‹æ–—ï¼Œä¹Ÿèƒ½ä¸€èµ·åˆ†äº«ç”Ÿæ´»çš„çç¢ä¸æ¸©æš–</textarea>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <span>ğŸ“ è¾¹è·</span>
                        <span id="paddingValue">60px</span>
                    </div>
                    <input type="range" id="padding" min="40" max="120" value="60" 
                           oninput="document.getElementById('paddingValue').textContent = this.value + 'px'">
                </div>

                <div class="form-group">
                    <label>ğŸ¨ èƒŒæ™¯æ ·å¼ï¼ˆå…±42ç§ï¼‰</label>
                    <div class="bg-options" id="bgOptions">
                        <!-- èƒŒæ™¯é€‰é¡¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <div class="button-group">
                    <button class="btn btn-primary" onclick="generate()">
                        <span>ğŸ¨ ç”Ÿæˆ</span>
                    </button>
                    <button class="btn btn-secondary" onclick="exportImg()">
                        <span>ğŸ’¾ å¯¼å‡º</span>
                    </button>
                </div>
            </div>

            <div class="preview-section">
                <div class="section-title">ğŸ‘€ é¢„è§ˆ</div>
                <div id="preview">
                    <div style="text-align: center; padding: 60px 20px; color: #999;">
                        ç‚¹å‡»ç”Ÿæˆé¢„è§ˆ
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let canvasList = [];

        // èƒŒæ™¯é…ç½®æ•°æ®
        const backgrounds = [
            // çº¯è‰²ç³»åˆ—
            { id: 'black', name: 'ç»å…¸é»‘', type: 'solid', color: '#000000', textColor: '#FFFFFF' },
            { id: 'white', name: 'çº¯å‡€ç™½', type: 'solid', color: '#FFFFFF', textColor: '#000000' },
            { id: 'navy', name: 'æ·±æµ·è“', type: 'solid', color: '#1a1a2e', textColor: '#FFFFFF' },
            { id: 'wine', name: 'é…’çº¢è‰²', type: 'solid', color: '#3d1e28', textColor: '#FFFFFF' },
            { id: 'forest', name: 'å¢¨ç»¿è‰²', type: 'solid', color: '#1e3a20', textColor: '#FFFFFF' },
            { id: 'gray', name: 'é«˜çº§ç°', type: 'solid', color: '#2c2c2c', textColor: '#FFFFFF' },
            { id: 'cream', name: 'ç±³ç™½è‰²', type: 'solid', color: '#f5f5dc', textColor: '#000000' },
            { id: 'beige', name: 'ç±³é»„è‰²', type: 'solid', color: '#f5e6d3', textColor: '#333333' },
            { id: 'lightgray', name: 'æµ…ç°è‰²', type: 'solid', color: '#e8e8e8', textColor: '#333333' },
            
            // æ¸å˜è‰²ç³»åˆ— - ç´«è‰²ç³»
            { id: 'grad1', name: 'æ¢¦å¹»ç´«', type: 'gradient', colors: ['#667eea', '#764ba2'], textColor: '#FFFFFF' },
            { id: 'grad2', name: 'è–°è¡£è‰', type: 'gradient', colors: ['#a8c0ff', '#3f2b96'], textColor: '#FFFFFF' },
            { id: 'grad3', name: 'ç¥ç§˜ç´«', type: 'gradient', colors: ['#8E2DE2', '#4A00E0'], textColor: '#FFFFFF' },
            
            // è“è‰²ç³»
            { id: 'grad4', name: 'æµ·æ´‹è“', type: 'gradient', colors: ['#2193b0', '#6dd5ed'], textColor: '#FFFFFF' },
            { id: 'grad5', name: 'å¤©ç©ºè“', type: 'gradient', colors: ['#4facfe', '#00f2fe'], textColor: '#FFFFFF' },
            { id: 'grad6', name: 'æ·±æµ·è“', type: 'gradient', colors: ['#134E5E', '#71B280'], textColor: '#FFFFFF' },
            { id: 'grad7', name: 'å†°å·è“', type: 'gradient', colors: ['#00c6ff', '#0072ff'], textColor: '#FFFFFF' },
            
            // ç²‰çº¢è‰²ç³»
            { id: 'grad8', name: 'æµªæ¼«ç²‰', type: 'gradient', colors: ['#f093fb', '#f5576c'], textColor: '#FFFFFF' },
            { id: 'grad9', name: 'æ¨±èŠ±ç²‰', type: 'gradient', colors: ['#ffecd2', '#fcb69f'], textColor: '#333333' },
            { id: 'grad10', name: 'æ¡ƒå¿ƒç²‰', type: 'gradient', colors: ['#ff9a9e', '#fecfef'], textColor: '#333333' },
            
            // æ©™é»„è‰²ç³»
            { id: 'grad11', name: 'æ—¥è½æ©™', type: 'gradient', colors: ['#fa709a', '#fee140'], textColor: '#333333' },
            { id: 'grad12', name: 'é‡‘è‰²é˜³å…‰', type: 'gradient', colors: ['#f7971e', '#ffd200'], textColor: '#333333' },
            { id: 'grad13', name: 'æŸ æª¬é»„', type: 'gradient', colors: ['#f6d365', '#fda085'], textColor: '#333333' },
            
            // ç»¿è‰²ç³»
            { id: 'grad14', name: 'æ£®æ—ç»¿', type: 'gradient', colors: ['#0ba360', '#3cba92'], textColor: '#FFFFFF' },
            { id: 'grad15', name: 'è–„è·ç»¿', type: 'gradient', colors: ['#a8edea', '#fed6e3'], textColor: '#333333' },
            { id: 'grad16', name: 'ç¿¡ç¿ ç»¿', type: 'gradient', colors: ['#00b09b', '#96c93d'], textColor: '#FFFFFF' },
            
            // çº¢è‰²ç³»
            { id: 'grad17', name: 'ç«ç‘°çº¢', type: 'gradient', colors: ['#eb3349', '#f45c43'], textColor: '#FFFFFF' },
            { id: 'grad18', name: 'ç«ç„°çº¢', type: 'gradient', colors: ['#fc4a1a', '#f7b733'], textColor: '#FFFFFF' },
            
            // æ··åˆè‰²ç³»
            { id: 'grad19', name: 'å½©è™¹ç³–', type: 'gradient', colors: ['#4facfe', '#00f2fe'], textColor: '#FFFFFF' },
            { id: 'grad20', name: 'æå…‰', type: 'gradient', colors: ['#fa709a', '#fee140', '#30cfd0'], textColor: '#333333' },
            { id: 'grad21', name: 'éœ“è™¹ç¯', type: 'gradient', colors: ['#f857a6', '#ff5858'], textColor: '#FFFFFF' },
            
            // çº¸è´¨çº¹ç†ç³»åˆ—
            { id: 'note', name: 'ä¾¿ç­¾çº¸', type: 'note', textColor: '#333333' },
            { id: 'grid', name: 'æ–¹æ ¼çº¸', type: 'grid', textColor: '#000000' },
            { id: 'lined', name: 'æ¨ªçº¿çº¸', type: 'lined', textColor: '#000000' },
            { id: 'dot', name: 'ç‚¹é˜µçº¸', type: 'dot', textColor: '#000000' },
            
            // é«˜çº§æ¸å˜
            { id: 'grad22', name: 'æ™¨æ›¦', type: 'gradient', colors: ['#ff9966', '#ff5e62'], textColor: '#FFFFFF' },
            { id: 'grad23', name: 'é»„æ˜', type: 'gradient', colors: ['#ff6e7f', '#bfe9ff'], textColor: '#333333' },
            { id: 'grad24', name: 'æ˜Ÿç©º', type: 'gradient', colors: ['#0f2027', '#203a43', '#2c5364'], textColor: '#FFFFFF' },
            { id: 'grad25', name: 'æåœ°', type: 'gradient', colors: ['#ffd89b', '#19547b'], textColor: '#FFFFFF' },
            { id: 'grad26', name: 'æ·±æ¸Š', type: 'gradient', colors: ['#2c3e50', '#3498db'], textColor: '#FFFFFF' },
            { id: 'grad27', name: 'æ¨±æ¡ƒ', type: 'gradient', colors: ['#eb3349', '#f45c43'], textColor: '#FFFFFF' },
        ];

        // åŠ¨æ€ç”ŸæˆèƒŒæ™¯é€‰é¡¹
        function initBackgrounds() {
            const container = document.getElementById('bgOptions');
            backgrounds.forEach((bg, index) => {
                const option = document.createElement('div');
                option.className = 'bg-option';
                
                const input = document.createElement('input');
                input.type = 'radio';
                input.name = 'bgStyle';
                input.id = `bg-${bg.id}`;
                input.value = bg.id;
                if (index === 0) input.checked = true;
                
                const label = document.createElement('label');
                label.htmlFor = `bg-${bg.id}`;
                
                const preview = document.createElement('div');
                preview.className = 'bg-preview';
                
                if (bg.type === 'solid') {
                    preview.style.background = bg.color;
                } else if (bg.type === 'gradient') {
                    preview.style.background = `linear-gradient(135deg, ${bg.colors.join(', ')})`;
                } else if (bg.type === 'note') {
                    preview.style.background = 'linear-gradient(to bottom, #fef9e7 0%, #fef5d4 100%)';
                } else if (bg.type === 'grid') {
                    preview.style.background = 'white';
                    preview.style.backgroundImage = 'linear-gradient(#e0e0e0 1px, transparent 1px), linear-gradient(90deg, #e0e0e0 1px, transparent 1px)';
                    preview.style.backgroundSize = '20px 20px';
                } else if (bg.type === 'lined') {
                    preview.style.background = 'white';
                    preview.style.backgroundImage = 'repeating-linear-gradient(0deg, #e0e0e0, #e0e0e0 1px, transparent 1px, transparent 30px)';
                } else if (bg.type === 'dot') {
                    preview.style.background = 'white';
                    preview.style.backgroundImage = 'radial-gradient(circle, #e0e0e0 1px, transparent 1px)';
                    preview.style.backgroundSize = '20px 20px';
                }
                
                const name = document.createElement('span');
                name.className = 'bg-name';
                name.textContent = bg.name;
                
                label.appendChild(preview);
                label.appendChild(name);
                option.appendChild(input);
                option.appendChild(label);
                container.appendChild(option);
            });
        }

        function splitContent(text, maxChars) {
            const lines = text.split('\n').filter(l => l.trim());
            const pages = [];
            let current = [];
            let count = 0;

            for (let line of lines) {
                if (count + line.length > maxChars && current.length > 0) {
                    pages.push(current.join('\n'));
                    current = [line];
                    count = line.length;
                } else {
                    current.push(line);
                    count += line.length;
                }
            }

            if (current.length > 0) {
                pages.push(current.join('\n'));
            }

            return pages.length > 0 ? pages : [text];
        }

        function wrapText(ctx, text, maxWidth) {
            const chars = text.split('');
            const lines = [];
            let line = '';

            for (let char of chars) {
                const test = line + char;
                const width = ctx.measureText(test).width;
                if (width > maxWidth && line) {
                    lines.push(line);
                    line = char;
                } else {
                    line = test;
                }
            }

            if (line) lines.push(line);
            return lines;
        }

        function drawBg(ctx, w, h, bgId) {
            const bg = backgrounds.find(b => b.id === bgId);
            if (!bg) return '#000';

            if (bg.type === 'solid') {
                ctx.fillStyle = bg.color;
                ctx.fillRect(0, 0, w, h);
            } else if (bg.type === 'gradient') {
                const gradient = ctx.createLinearGradient(0, 0, w, h);
                bg.colors.forEach((color, i) => {
                    gradient.addColorStop(i / (bg.colors.length - 1), color);
                });
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, w, h);
            } else if (bg.type === 'note') {
                const grad = ctx.createLinearGradient(0, 0, 0, h);
                grad.addColorStop(0, '#fef9e7');
                grad.addColorStop(1, '#fef5d4');
                ctx.fillStyle = grad;
                ctx.fillRect(0, 0, w, h);
                
                ctx.strokeStyle = '#e8dcc0';
                ctx.lineWidth = 3;
                for (let i = 0; i < w; i += 20) {
                    ctx.beginPath();
                    ctx.moveTo(i, 0);
                    ctx.lineTo(i + 10, 0);
                    ctx.stroke();
                }
            } else if (bg.type === 'grid') {
                ctx.fillStyle = '#fff';
                ctx.fillRect(0, 0, w, h);
                
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                for (let i = 0; i <= w; i += 40) {
                    ctx.beginPath();
                    ctx.moveTo(i, 0);
                    ctx.lineTo(i, h);
                    ctx.stroke();
                }
                for (let i = 0; i <= h; i += 40) {
                    ctx.beginPath();
                    ctx.moveTo(0, i);
                    ctx.lineTo(w, i);
                    ctx.stroke();
                }
            } else if (bg.type === 'lined') {
                ctx.fillStyle = '#fff';
                ctx.fillRect(0, 0, w, h);
                
                ctx.strokeStyle = '#e0e0e0';
                ctx.lineWidth = 1;
                for (let i = 60; i < h; i += 60) {
                    ctx.beginPath();
                    ctx.moveTo(0, i);
                    ctx.lineTo(w, i);
                    ctx.stroke();
                }
            } else if (bg.type === 'dot') {
                ctx.fillStyle = '#fff';
                ctx.fillRect(0, 0, w, h);
                
                ctx.fillStyle = '#e0e0e0';
                for (let x = 0; x < w; x += 20) {
                    for (let y = 0; y < h; y += 20) {
                        ctx.beginPath();
                        ctx.arc(x, y, 1.5, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }
            }

            return bg.textColor;
        }

        function generate() {
            const title = document.getElementById('title').value;
            const content = document.getElementById('content').value;
            const padding = parseInt(document.getElementById('padding').value);
            const bgStyle = document.querySelector('input[name="bgStyle"]:checked').value;

            if (!title || !content) {
                alert('è¯·å¡«å†™æ ‡é¢˜å’Œå†…å®¹');
                return;
            }

            const pages = splitContent(content, 350);
            canvasList = [];

            const preview = document.getElementById('preview');
            preview.innerHTML = '';

            pages.forEach((pageContent, idx) => {
                const wrap = document.createElement('div');
                wrap.className = 'canvas-wrapper';

                const label = document.createElement('div');
                label.className = 'canvas-label';
                label.textContent = `ç¬¬ ${idx + 1} é¡µ / å…± ${pages.length} é¡µ`;

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                canvas.width = 1080;
                canvas.height = 1440;

                const textColor = drawBg(ctx, 1080, 1440, bgStyle);
                ctx.fillStyle = textColor;

                let y = 100;

                if (idx === 0) {
                    ctx.font = 'bold 64px "Microsoft YaHei"';
                    const titleLines = wrapText(ctx, title, 1080 - padding * 2);
                    titleLines.forEach(line => {
                        ctx.fillText(line, padding, y);
                        y += 80;
                    });
                    y += 40;
                }

                ctx.font = '48px "Microsoft YaHei"';
                const lines = pageContent.split('\n');
                lines.forEach(line => {
                    if (line.trim()) {
                        const wrapped = wrapText(ctx, line, 1080 - padding * 2);
                        wrapped.forEach(l => {
                            if (y < 1340) {
                                ctx.fillText(l, padding, y);
                                y += 70;
                            }
                        });
                        y += 20;
                    }
                });

                if (pages.length > 1) {
                    ctx.font = '36px "Microsoft YaHei"';
                    ctx.textAlign = 'center';
                    ctx.fillText(`${idx + 1}/${pages.length}`, 540, 1390);
                }

                wrap.appendChild(label);
                wrap.appendChild(canvas);
                preview.appendChild(wrap);
                canvasList.push(canvas);
            });
        }

        async function exportImg() {
            if (canvasList.length === 0) {
                alert('è¯·å…ˆç”Ÿæˆé¢„è§ˆ');
                return;
            }

            if (canvasList.length === 1) {
                canvasList[0].toBlob(blob => {
                    saveAs(blob, 'ç›¸äº²æ–‡æ¡ˆ.png');
                });
            } else {
                const zip = new JSZip();
                for (let i = 0; i < canvasList.length; i++) {
                    const blob = await new Promise(resolve => {
                        canvasList[i].toBlob(resolve, 'image/png');
                    });
                    zip.file(`ç›¸äº²æ–‡æ¡ˆ_${i + 1}.png`, blob);
                }
                const zipBlob = await zip.generateAsync({type: 'blob'});
                saveAs(zipBlob, 'ç›¸äº²æ–‡æ¡ˆ.zip');
            }
        }

        window.onload = function() {
            initBackgrounds();
            generate();
        };
    </script>
</body>
</html>
